# Production environment Grafana values
replicas: 2

resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 250m
    memory: 512Mi

# Larger persistence for production
persistence:
  enabled: true
  size: 50Gi
  storageClassName: "fast-ssd"

# Production credentials via external secret
adminPassword: ""
admin:
  existingSecret: grafana-admin-credentials
  userKey: admin-user
  passwordKey: admin-password

# Production ingress with TLS - using traefik
ingress:
  enabled: true
  ingressClassName: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - grafana.example.com
  tls:
    - secretName: grafana-prod-tls
      hosts:
        - grafana.example.com

# HA configuration
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - grafana
          topologyKey: kubernetes.io/hostname

grafana.ini:
  server:
    root_url: "https://grafana.example.com"
    serve_from_sub_path: false
  
  log:
    level: warn
  
  security:
    disable_gravatar: true
    cookie_secure: true
    cookie_samesite: strict
    strict_transport_security: true
    strict_transport_security_max_age_seconds: 31536000
    x_content_type_options: true
    x_xss_protection: true
  
  auth:
    disable_login_form: false
    disable_signout_menu: false
  
  auth.anonymous:
    enabled: false
  
  users:
    allow_sign_up: false
    allow_org_create: false
    auto_assign_org: true
    auto_assign_org_role: Viewer
  
  alerting:
    enabled: true
    execute_alerts: true

# Alerting
alerting:
  enabled: true
  contactpoints:
    - name: slack-notifications
      type: slack
      settings:
        url: ""  # Set via secret

# SMTP configuration for alerts
smtp:
  enabled: false

