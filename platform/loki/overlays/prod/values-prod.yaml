# Production environment Loki values
# Using scalable mode for production
deploymentMode: SimpleScalable

# Disable single binary mode
singleBinary:
  replicas: 0

# Read path
read:
  replicas: 3
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 512Mi
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app.kubernetes.io/component
                  operator: In
                  values:
                    - read
            topologyKey: kubernetes.io/hostname

# Write path
write:
  replicas: 3
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 512Mi
  persistence:
    enabled: true
    size: 50Gi
    storageClass: "fast-ssd"
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app.kubernetes.io/component
                  operator: In
                  values:
                    - write
            topologyKey: kubernetes.io/hostname

# Backend
backend:
  replicas: 3
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi
  persistence:
    enabled: true
    size: 20Gi

# Gateway (HA)
gateway:
  replicas: 3
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchExpressions:
                - key: app.kubernetes.io/component
                  operator: In
                  values:
                    - gateway
            topologyKey: kubernetes.io/hostname

loki:
  auth_enabled: true
  
  commonConfig:
    replication_factor: 3
  
  limits_config:
    retention_period: 720h  # 30 days for production
    ingestion_rate_mb: 50
    ingestion_burst_size_mb: 100
    max_query_parallelism: 64
    max_query_series: 1000
    max_streams_per_user: 50000
  
  # For production, consider using object storage (S3, GCS, etc.)
  # storage:
  #   type: s3
  #   s3:
  #     endpoint: s3.amazonaws.com
  #     region: us-east-1
  #     bucketnames: loki-logs-prod
  #     secretAccessKey: ${AWS_SECRET_ACCESS_KEY}
  #     accessKeyId: ${AWS_ACCESS_KEY_ID}

