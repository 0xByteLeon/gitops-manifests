# OpenTelemetry Demo Helm Chart Values
# 官方微服务示例应用，用于测试链路追踪
# Chart version: 0.32.8

# 禁用内置的可观测性组件（使用我们自己的 LGTM 栈）
opentelemetry-collector:
  enabled: false

jaeger:
  enabled: false

prometheus:
  enabled: false

grafana:
  enabled: false

opensearch:
  enabled: false

# 默认配置
default:
  # 使用我们自己的 OTel Collector (跨 namespace 访问)
  env:
    - name: OTEL_COLLECTOR_NAME
      value: "otel-collector-opentelemetry-collector.opentelemetry.svc"
  envOverrides:
    - name: OTEL_EXPORTER_OTLP_ENDPOINT
      value: "http://otel-collector-opentelemetry-collector.opentelemetry.svc:4317"

# 各服务配置
components:
  # 前端 Web UI
  frontend:
    enabled: true
    service:
      port: 8080
    resources:
      limits:
        memory: 256Mi

  # 前端代理
  frontendProxy:
    enabled: true
    service:
      port: 8080
    resources:
      limits:
        memory: 128Mi

  # 负载生成器 - 自动生成流量和 Traces
  # 启用浏览器流量模拟需要更多内存
  loadgenerator:
    enabled: true
    resources:
      limits:
        memory: 1Gi

  # 产品目录服务
  productCatalogService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 推荐服务
  recommendationService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 购物车服务
  cartService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 结账服务
  checkoutService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 货币服务
  currencyService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 邮件服务
  emailService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 支付服务
  paymentService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 配送服务
  shippingService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 广告服务
  adService:
    enabled: true
    resources:
      limits:
        memory: 512Mi

  # 报价服务
  quoteService:
    enabled: true
    resources:
      limits:
        memory: 256Mi

  # 会计服务 (需要 Kafka)
  accountingService:
    enabled: false

  # 欺诈检测服务 (需要 Kafka)
  frauddetectionService:
    enabled: false

  # 图片提供服务
  imageprovider:
    enabled: false

  # Flagd (特性标志)
  flagd:
    enabled: true
    resources:
      limits:
        memory: 128Mi

  # Kafka
  kafka:
    enabled: false

  # Valkey (Redis 替代，用于购物车存储)
  valkey:
    enabled: true
    resources:
      limits:
        memory: 128Mi
